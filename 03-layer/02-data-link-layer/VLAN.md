## VLAN(Virtual LAN)

### 등장 배경
- 레이어2 스위치는 하나의 이더넷 네트워크를 구성하는 네트워크 기기인데, 하나의 네트워크에 수많은 기기를 연결하면 불필요한 데이터 전송이 많이 발생하게 된다.
#### 예시
1. 2개의 스위치에 각각 컴퓨터가 하나씩 연결되었다고 가정 시(스위치도 서로 연결되어 있지 않음)
   - 2개의 컴퓨터는 서로 통신할 방법이 없음(물리적 LAN 환경)

2. 네트워크 장비에 10대의 컴퓨터가 연결되어 있는 경우
    - 각각의 컴퓨터가 다른 컴퓨터의 MAC 주소를 알기 위해 ARP Request를 보낸다. (최소 10번 이상)
    - 컴퓨터가 많으면 많아질 수록 ARP Request가 기하급수적으로 증가, 이는 브로드캐스트가 증가한다는 의미로 데이터 전달 속도가 눈에 띄게 느려질 것이다.


> 이러한 문제를 해결하기 위해 레이어2 스위치에서 '하나'의 네트워크를 구성하는 방식이 아닌, 네트워크를 복수로 분할할 수 있게 하는 기술이 등장


### 동작원리
- 일반 레이어2 스위치는 모든 포트 사이에서 이더넷 프레임을 전송할 수 있는데, 이것을 VLAN으로 나누어 **같은 VLAN에 할당된 포트끼리만 이더넷 프레임을 전송**하도록 한다.
- MAC 주소 테이블에 VLAN ID 가 저장된다
    - 예시 (MAC 주소 테이블, 이더넷 헤더)
    - 포트 1 : MAC 주소 AAA , VLAN 10
    - 포트 2 : MAC 주소 BBB, VLAN 10
    - 포트 3 : MAC 주소 CCC, VLAN 20
    - 포트 4 : MAC 주소 DDD, VLAN 20
    - 포트 1, 2에는 `VLAN10`, 포트 3,4 에는 `VLAN20` 이 할당되었다.
    - `VLAN10` 의 포트1,2만 이더넷 프레임 전송이 가능
    - `VLAN20` 의 포트 3,4만 이더넷 프레임 전송이 가능
  > VLAN이 다른 포트 사이에서는 이더넷 프레임을 전송할 수 없다.(라우터, 레이어3 스위치 등이 필요하다.)

### 장점
- 레이어2 스위치를 가상으로 분할하는 것으로, **분할한 VLAN의 스위치가 될 포트는 자유롭게 결정**할 수 있다.(관리 용이)
- VLAN 별 스위치 사이는 연결되어 있지 않으므로 데이터가 전송되는 범위를 제한할 수 있어 보안을 향상시킬 수 있다.
- 비용 절감
  - 서로 차단된 LAN 환경을 구축할 때 장비가 추가로 필요하지 않다.
- 불필요한 트래픽 감소
  - VLAN 은 서로 다른 네트워크 그룹이기 때문에 브로드캐스트 패킷이 다른 VLAN으로 전송되지 않는다.
  - 불필요한 트래픽을 현저히 줄일 수 있다.

### 주의점
- network layer 에서 배울 라우터도 네트워크를 분리하지만, 라우터로 분할된 네트워크는 라우터로 서로 연결되어 있다.
- 단, VLAN을 통해 분할한 네트워크는 서로 통신하기 위해서난 라우터와 레이어3 스위치가 필요하다
    - VLAN 끼리 연결해서 서로 통신할 수 있게 하는 것을 VLAN 라우팅 이라고 한다.

### VLAN Tagging
> VLAN을 구분하기 위해 패킷에 태그를 추가하여(프레임의 헤더) 전송하는 기술
- 태그 VLAN 포트를 이용해 복수의 레이어2 스위치로 VLNA 을 구성 시, 레이어2 스위치 간의 접속을 한 줄로 해결할 수 있다.


### VLAN Trunk
> 여러 개의 물리적인 링크 상에서 여러 개의 VLAN을 전송하기 위한 기술

### [VLAN 을 확장시킨 VXLAN](https://github.com/royroyee/gonet/blob/main/03-layer/03-network-layer/Overlay.md#vxlan)
